<script>
    const BASE_URL = window.location.hostname === "localhost" 
        ? "http://localhost:8080" 
        : "https://getfood-springboot-8.onrender.com"; // Replace with your Render URL

    async function fetchFoodPosts() {
        try {
            let response = await fetch(`${BASE_URL}/food/all`);
            if (!response.ok) throw new Error("Failed to fetch data");

            let foodPosts = await response.json();
            let foodList = document.getElementById("foodList");
            foodList.innerHTML = "";

            foodPosts.forEach(food => {
                let div = document.createElement("div");
                div.classList.add("food-item");
                div.innerHTML = `<strong>${food.foodName}</strong><br>
                                 ${food.description}<br>
                                 <em>Pickup Location: ${food.pickupLocation}</em>
                                 <br><button class='receive-btn' onclick="deleteFood(${food.id})">Receive</button>`;
                foodList.appendChild(div);
            });

        } catch (error) {
            console.error("Error fetching data:", error);
        }
    }

    async function deleteFood(foodId) {
        try {
            let response = await fetch(`${BASE_URL}/food/delete/${foodId}`, {
                method: 'DELETE',
            });

            if (response.ok) {
                alert("Food received successfully!");
                fetchFoodPosts(); // Refresh list after deletion
            } else {
                alert("Error deleting food.");
            }
        } catch (error) {
            console.error("Error:", error);
        }
    }

    function goHome() {
        window.location.href = "index.html";
    }
    function goSender() {
        window.location.href = "sender.html";
    }
</script>
